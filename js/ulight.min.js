$(function(){var t=[{inner:250,outer:270}],e=d3.select("#canvas").append("svg").attr("width",1e3).attr("height",1e3),r=e.append("defs").append("radialGradient").attr("id","radial-gradient");r.append("stop").attr("offset","0%").attr("stop-color","#fffa05"),r.append("stop").attr("offset","100%").attr("stop-color","#fff"),e.append("circle").attr("id","lightBulbInside").attr("cx",500).attr("cy",300).attr("r",350).style("fill","white").on("click",function(){"rgb(255, 255, 255)"==d3.select(this).style("fill")?d3.select(this).style("fill","url(#radial-gradient)"):d3.select(this).style("fill","white")});var a=d3.svg.arc().innerRadius(function(t){return t.data.inner}).outerRadius(function(t){return t.data.outer}).startAngle(-Math.PI/2-1.1).endAngle(Math.PI/2+1.1),n=d3.layout.pie();e.selectAll("path").data(n(t)).enter().append("path").attr("d",function(t){return a(t)}).attr("stroke","black").style("stroke-linejoin","round").attr("fill",function(t,e){return"black"}).attr("class","pie").attr("transform","translate(500, 300)");var i=[{width:205,height:20,y:540},{width:205,height:20,y:575},{width:150,height:20,y:610},{width:120,height:20,y:645}];e.selectAll("rect").data(i).enter().append("rect").attr("x",function(t){return(1e3-t.width)/2}).attr("y",function(t){return t.y}).attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).style("fill","black").attr("rx",10),e.append("text").attr("id","utext").attr("x",0).attr("y",500).text("U").attr("font-size","250px");var l=d3.select("#utext"),d=l.node().getBoundingClientRect().width;l.attr("x",(1e3-d)/2),l.on("click",function(){"rgb(255, 255, 255)"==d3.select("circle[id='lightBulbInside']").style("fill")?d3.select("circle[id='lightBulbInside']").style("fill","url(#radial-gradient)"):d3.select("circle[id='lightBulbInside']").style("fill","white")});var o=function(t,e){return Math.floor(Math.random()*(e-t))+t};setInterval(function(){d3.select("path#ulightCenter").remove();for(var t=[{num:"1",all:100}],r=2;r<23;r++)t.push({num:r,all:o(0,850)});t.push({num:23,all:100});var a={top:40,right:20,bottom:30,left:40},n=960-a.left-a.right,i=500-a.top-a.bottom,l=["linear","cardinal","monotone"],d=l[Math.floor(Math.random()*l.length)],s=d3.scale.ordinal().rangeBands([0,140],.25,.5),c=d3.scale.linear().range([i,500]);s.domain(t.map(function(t){return t.num})),c.domain([0,d3.max(t,function(t){return t.all})]);var u=d3.svg.line().interpolate(d).x(function(t){return s(t.num)+n/2-16}).y(function(t){return c(t.all)-120}),h=e.append("path").attr("id","ulightCenter").attr("d",u(t)).attr("stroke","#efe009").attr("stroke-width",8).attr("fill","none"),f=h.node().getTotalLength();h.attr("stroke-dasharray",f+" "+f).attr("stroke-dashoffset",f).transition().duration(250).ease("linear").attr("stroke-dashoffset",0)},750)});
